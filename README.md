# n8n-llm-image-pipeline

This workflow demonstrates a serverless approach to generating images from a text prompt. It uses a Large Language Model (LLM) to refine the user's input into a high-quality, specific image prompt, which is then used by a powerful text-to-image model, with the final image automatically saved to Google Drive.

This template is built using **n8n** (a workflow automation tool).

## ‚ú® Workflow Overview

The workflow processes a simple text idea into a final image:

1.  **Receive Input:** A chat message (your image idea) is received via a webhook trigger.
2.  **Prompt Refinement (LLM):** The input is sent to a conversational model (e.g., **Gemini 2.0 Flash** via OpenRouter) to be refined into a detailed, realistic-style image prompt.
3.  **Image Generation:** The refined prompt is sent to the image generation model on Hugging Face.
4.  **Save Output:** The resulting image file is automatically uploaded to a specified folder in **Google Drive**.

## üõ†Ô∏è Prerequisites

To run this workflow, you need the following accounts and credentials configured in your n8n instance:

1.  **n8n Instance:** (Self-hosted or Cloud).
2.  **Hugging Face API Token:** For authenticating the image generation request (`HTTP Request` node).
3.  **OpenRouter API Key:** For accessing the Gemini model for prompt refinement (`OpenRouter Chat Model` node).
4.  **Google Drive OAuth2 Credential:** To securely save the final generated images (`Upload file` node).

## üöÄ Setup & Usage

### 1. Import the Workflow

1.  Copy the JSON code provided to you previously (the one with placeholder comments).
2.  In your n8n instance, go to **Workflows** -> **New** -> **Import from JSON**.
3.  Paste the JSON code and import the workflow.

### 2. Configure Credentials

You must update the placeholder values (`REPLACE_...` and `YOUR_...`) in the following nodes with your actual credentials and settings:

| Node Name | Parameter | Action Required |
| :--- | :--- | :--- |
| **HTTP Request** | `Authorization` Header | **Replace** the placeholder with your actual Hugging Face API Token. |
| **OpenRouter Chat Model** | `Credentials` | **Select** the appropriate OpenRouter credential. |
| **Upload file** | `folderId` | **Select** your desired Google Drive folder. |
| **Upload file** | `Credentials` | **Select** your Google Drive OAuth2 credential. |

### 3. Run the Workflow

1.  Ensure the workflow is **Active**.
2.  Use the webhook URL generated by the **"When chat message received"** node.
3.  Send a message (your image idea, e.g., "A golden retriever in a spacesuit") to the webhook URL to trigger the workflow.
4.  The generated image will be saved to your configured Google Drive folder.

---

## ‚ö†Ô∏è Important Security Note

This workflow requires sensitive API keys and tokens. **NEVER hardcode your actual API keys directly into the public workflow JSON.** The provided JSON uses placeholders (`REPLACE_...`) to show where your secrets should be configured using n8n's secure **Credentials** feature.
